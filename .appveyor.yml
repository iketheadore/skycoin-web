image: Visual Studio 2017
platform:
  - x64

clone_folder: c:\gopath\src\github.com\skycoin\skycoin-web

environment:
  GOPATH: c:\gopath

cache:
  - 'electron\node_modules'
  - '%USERPROFILE%\.electron'

install:
  - echo %PATH%
  - echo %GOPATH%
  - set PATH=%GOPATH\bin;c:\go\bin;%PATH%
  - go version
  - go env
  - ps: Install-Product node 10.15 x64
  - npm install
  - cd electron && npm install && cd ..

build_script:
  - npm run build
  - cd electron
  - cmd: bash ./build-electron-release.sh 'windows'
  - ps: ls release\
  - ps: cd ..

after_build:
  - ps: 7z a skycoin-lite-win.zip c:\gopath\src\github.com\skycoin\skycoin-web\electron\release\*
  - ps: ls *.zip

artifacts:
  - path: skycoin-lite-win.zip
    name: skycoin-lite-win

deploy:
  provider: GitHub
  auth_token: $(GB_AUTH)
  artifact: skycoin-lite-win
  on:
    APPVEYOR_REPO_TAG: true
